{"version":3,"file":"mongodb.js","names":["_winstonTransport","require","_winstonTransport2","_interopRequireDefault","_mongodb","obj","__esModule","default","module","exports","MongoTransport","Transport","constructor","opts","client","MongoClient","uri","db","collection","log","info","callback","connect","insertOne","setImmediate","emit","error","close"],"sources":["../../src/transports/mongodb.js"],"sourcesContent":["import Transport from \"winston-transport\";\nimport { MongoClient } from \"mongodb\";\n\nmodule.exports = class MongoTransport extends Transport {\n  constructor(opts) {\n    super(opts);\n    this.client = new MongoClient(opts.uri);\n    this.db = this.client.db(\"test\");\n    this.collection = this.db.collection(\"log\");\n  }\n\n  async log(info, callback) {\n    try {\n      await this.client.connect();\n      await this.collection.insertOne(info);\n      setImmediate(() => {\n        this.emit(\"logged\", info);\n      });\n      callback();\n    } catch (error) {\n      callback(error);\n    } finally {\n      await client.close();\n    }\n  }\n};\n"],"mappings":"aAAA,IAAAA,iBAAA,GAAAC,OAAA,sBAA0C,IAAAC,kBAAA,GAAAC,sBAAA,CAAAH,iBAAA;AAC1C,IAAAI,QAAA,GAAAH,OAAA,YAAsC,SAAAE,uBAAAE,GAAA,UAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;;AAEtCG,MAAM,CAACC,OAAO,GAAG,MAAMC,cAAc,SAASC,0BAAS,CAAC;EACtDC,WAAWA,CAACC,IAAI,EAAE;IAChB,KAAK,CAACA,IAAI,CAAC;IACX,IAAI,CAACC,MAAM,GAAG,IAAIC,oBAAW,CAACF,IAAI,CAACG,GAAG,CAAC;IACvC,IAAI,CAACC,EAAE,GAAG,IAAI,CAACH,MAAM,CAACG,EAAE,CAAC,MAAM,CAAC;IAChC,IAAI,CAACC,UAAU,GAAG,IAAI,CAACD,EAAE,CAACC,UAAU,CAAC,KAAK,CAAC;EAC7C;;EAEA,MAAMC,GAAGA,CAACC,IAAI,EAAEC,QAAQ,EAAE;IACxB,IAAI;MACF,MAAM,IAAI,CAACP,MAAM,CAACQ,OAAO,CAAC,CAAC;MAC3B,MAAM,IAAI,CAACJ,UAAU,CAACK,SAAS,CAACH,IAAI,CAAC;MACrCI,YAAY,CAAC,MAAM;QACjB,IAAI,CAACC,IAAI,CAAC,QAAQ,EAAEL,IAAI,CAAC;MAC3B,CAAC,CAAC;MACFC,QAAQ,CAAC,CAAC;IACZ,CAAC,CAAC,OAAOK,KAAK,EAAE;MACdL,QAAQ,CAACK,KAAK,CAAC;IACjB,CAAC,SAAS;MACR,MAAMZ,MAAM,CAACa,KAAK,CAAC,CAAC;IACtB;EACF;AACF,CAAC"}