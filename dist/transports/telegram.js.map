{"version":3,"file":"telegram.js","names":["_winstonTransport","require","_winstonTransport2","_interopRequireDefault","_ioredis","_ioredis2","_sha","_sha2","obj","__esModule","default","module","exports","MongoTransport","Transport","constructor","opts","host","port","username","password","redis","Redis","log","info","callback","console","hash","sha256","JSON","stringify","res","set","error","serve","keys"],"sources":["../../src/transports/telegram.js"],"sourcesContent":["import Transport from \"winston-transport\";\nimport Redis from \"ioredis\";\nimport sha256 from \"sha256\";\n\nmodule.exports = class MongoTransport extends Transport {\n  constructor(opts) {\n    super(opts);\n    const { host, port, username, password } = opts;\n    this.redis = new Redis();\n  }\n\n  async log(info, callback) {\n    console.log(\"log tg\");\n    try {\n      const hash = sha256(JSON.stringify(info));\n      const res = await this.redis.set(\n        `log-vault:tg:${hash}`,\n        JSON.stringify(info)\n      );\n      console.log(res);\n      callback(null, res);\n    } catch (error) {\n      console.error(error);\n      callback(error);\n    }\n  }\n\n  async serve() {\n    try {\n      const keys = await this.redis.keys(`log-vault:tg:*`);\n      console.log(keys);\n    } catch (error) {\n      console.error(error);\n    }\n  }\n};\n"],"mappings":"aAAA,IAAAA,iBAAA,GAAAC,OAAA,sBAA0C,IAAAC,kBAAA,GAAAC,sBAAA,CAAAH,iBAAA;AAC1C,IAAAI,QAAA,GAAAH,OAAA,YAA4B,IAAAI,SAAA,GAAAF,sBAAA,CAAAC,QAAA;AAC5B,IAAAE,IAAA,GAAAL,OAAA,WAA4B,IAAAM,KAAA,GAAAJ,sBAAA,CAAAG,IAAA,WAAAH,uBAAAK,GAAA,UAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;;AAE5BG,MAAM,CAACC,OAAO,GAAG,MAAMC,cAAc,SAASC,0BAAS,CAAC;EACtDC,WAAWA,CAACC,IAAI,EAAE;IAChB,KAAK,CAACA,IAAI,CAAC;IACX,MAAM,EAAEC,IAAI,EAAEC,IAAI,EAAEC,QAAQ,EAAEC,QAAQ,CAAC,CAAC,GAAGJ,IAAI;IAC/C,IAAI,CAACK,KAAK,GAAG,IAAIC,iBAAK,CAAC,CAAC;EAC1B;;EAEA,MAAMC,GAAGA,CAACC,IAAI,EAAEC,QAAQ,EAAE;IACxBC,OAAO,CAACH,GAAG,CAAC,QAAQ,CAAC;IACrB,IAAI;MACF,MAAMI,IAAI,GAAG,IAAAC,aAAM,EAACC,IAAI,CAACC,SAAS,CAACN,IAAI,CAAC,CAAC;MACzC,MAAMO,GAAG,GAAG,MAAM,IAAI,CAACV,KAAK,CAACW,GAAG;QAC7B,gBAAeL,IAAK,EAAC;QACtBE,IAAI,CAACC,SAAS,CAACN,IAAI;MACrB,CAAC;MACDE,OAAO,CAACH,GAAG,CAACQ,GAAG,CAAC;MAChBN,QAAQ,CAAC,IAAI,EAAEM,GAAG,CAAC;IACrB,CAAC,CAAC,OAAOE,KAAK,EAAE;MACdP,OAAO,CAACO,KAAK,CAACA,KAAK,CAAC;MACpBR,QAAQ,CAACQ,KAAK,CAAC;IACjB;EACF;;EAEA,MAAMC,KAAKA,CAAA,EAAG;IACZ,IAAI;MACF,MAAMC,IAAI,GAAG,MAAM,IAAI,CAACd,KAAK,CAACc,IAAI,CAAE,gBAAe,CAAC;MACpDT,OAAO,CAACH,GAAG,CAACY,IAAI,CAAC;IACnB,CAAC,CAAC,OAAOF,KAAK,EAAE;MACdP,OAAO,CAACO,KAAK,CAACA,KAAK,CAAC;IACtB;EACF;AACF,CAAC"}